<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>Friend Survey</title>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
		<script src="https://code.jquery.com/jquery.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
	</head>
	<body>
		<div class="container">
			<h2>Survey Questions</h2>
			<br>
			<h3><stong>About You</stong></h3>
			<form role="form" method="Post">
				<h4>name required</h4>
				<div class="input-group">
					<span class="input-group-addon"></span>
					<input type="text" class="form-control"  aria-describedby="basic-addon1" id="name">
				</div>
				<h4>Link to photo image (required)</h4>
				<div class="input-group">
					<span class="input-group-addon"> </span>
					<input type="url" class="form-control" aria-describedby="basic-addon1" id="photo">
				</div>
				
				<div><h3>Question One</h3>
					<h4> I prefer Orlando over Annaheim.</h4>
					<div class="dropdown">
						<select class="chosen-select" id="q1" type="number">
							<option value="0">make a selection</option>
							<option value="1">1 (Strongly Disagree)</option>
							<option value="2">2</option>
							<option value="3">3</option>
							<option value="4">4</option>
							<option value="5">5 (Strongly Agree)</option>
						</select>
					</div>
				</div>
				<div><h3>Question Two</h3>
					<h4>The Disney Parks are for grown-ups as well as kids.</h4>
					<div class="dropdown">
						<select class="chosen-select" id="q2" type="number">
							<option value="0">make a selection</option>
							<option value="1">1 (Strongly Disagree)</option>
							<option value="2">2</option>
							<option value="3">3</option>
							<option value="4">4</option>
							<option value="5">5 (Strongly Agree)</option>
						</select>
					</div>
				</div>
				<div><h3>Question Three</h3>
					<h4>If I could go on only one cruise it would be on a Disney ship.</h4>
					<div class="dropdown">
						<select class="chosen-select" id="q3" type="number">
							<option value="0">make a selection</option>
							<option value="1">1 (Strongly Disagree)</option>
							<option value="2">2</option>
							<option value="3">3</option>
							<option value="4">4</option>
							<option value="5">5 (Strongly Agree)</option>
						</select>
					</div>
				</div>
				<div><h3>Question Four</h3>
					<h4>The three little pigs should be slaughtered and turned into bacon.</h4>
					<div class="dropdown">
						<select class="chosen-select" id="q4" type="number">
							<option value="0">make a selection</option>
							<option value="1">1 (Strongly Disagree)</option>
							<option value="2">2</option>
							<option value="3">3</option>
							<option value="4">4</option>
							<option value="5">5 (Strongly Agree)</option>
						</select>
					</div>
				</div>
				<div><h3>Question Five</h3>
					<h4>I'd rather spend time with Snow White than the seven dwarfs.</h4>
					<div class="dropdown">
						<select class="chosen-select" id="q5" type="number">
							<option value="0">make a selection</option>
							<option value="1">1 (Strongly Disagree)</option>
							<option value="2">2</option>
							<option value="3">3</option>
							<option value="4">4</option>
							<option value="5">5 (Strongly Agree)</option>
						</select>
					</div>
				</div>
				<div><h3>Question Six</h3>
					<h4>Mary Poppins is one of the best movies ever made.</h4>
					<div class="dropdown">
						<select class="chosen-select" id="q6" type="number">
							<option value="0">make a selection</option>
							<option value="1">1 (Strongly Disagree)</option>
							<option value="2">2</option>
							<option value="3">3</option>
							<option value="4">4</option>
							<option value="5">5 (Strongly Agree)</option>
						</select>
					</div>
				</div>
				<div><h3>Question Seven</h3>
					<h4>I'd rather visit Epcot than Europe.</h4>
					<div class="dropdown">
						<select class="chosen-select" id="q7" type="number">
							<option value="0">make a selection</option>
							<option value="1">1 (Strongly Disagree)</option>
							<option value="2">2</option>
							<option value="3">3</option>
							<option value="4">4</option>
							<option value="5">5 (Strongly Agree)</option>
						</select>
					</div>
				</div>
				<div><h3>Question Eight</h3>
					<h4> The Swiss Family Robinson treehouse is way cooler than than the Disney Castle.</h4>
					<div class="dropdown">
						<select class="chosen-select" id="q8" type="number">
							<option value="0">make a selection</option>
							<option value="1">1 (Strongly Disagree)</option>
							<option value="2">2</option>
							<option value="3">3</option>
							<option value="4">4</option>
							<option value="5">5 (Strongly Agree)</option>
						</select>
					</div>
				</div>
				<div><h3>Question Nine</h3>
					<h4>Forget "Pirates of the Carribean" I'd rather float down "It's a Small World".</h4>
					<div class="dropdown">
						<select class="chosen-select" id="q9" type="number">
							<option value="0">make a selection</option>
							<option value="1">1 (Strongly Disagree)</option>
							<option value="2">2</option>
							<option value="3">3</option>
							<option value="4">4</option>
							<option value="5">5 (Strongly Agree)</option>
						</select>
					</div>
				</div>
				<div><h3>Question Ten</h3>
					<h4>The Disney Parks really are the "the happiest places on earth".</h4>
					<div class="dropdown">
						<select class="chosen-select" id="q10" type="number">
							<option value="0">make a selection</option>
							<option value="1">1 (Strongly Disagree)</option>
							<option value="2">2</option>
							<option value="3">3</option>
							<option value="4">4</option>
							<option value="5">5 (Strongly Agree)</option>
						</select>
					</div>
				</div>
				<button type="submit" class="btn btn-primary btn-lg btn-block" id="submit"><i class="fa fa-check-circle" aria-hidden="true"></i>
				Submit</button>
			</form>
		</div>
	</body>
</html>
<script type="text/javascript">


	$("#submit").on("click", function(event) {
event.preventDefault();
// Here we grab the form elements
	var newSurvey = {
	customerName: $("#name").val().trim(),
	customerPhoto: $("#photo").val().trim(),
	customerScore: [parseFloat($("#q1").val().trim()),
					parseFloat($("#q2").val().trim()),
					parseFloat($("#q3").val().trim()),
					parseFloat($("#q4").val().trim()),
					parseFloat($("#q5").val().trim()),
					parseFloat($("#q6").val().trim()),
					parseFloat($("#q7").val().trim()),
					parseFloat($("#q8").val().trim()),
					parseFloat($("#q9").val().trim()),
					parseFloat($("#q10").val().trim())
					],
	};
//console.log("THIS IS NEW SURVEY.customerScore " + newSurvey.customerScore);
// let newSurveySum = (newSurvey.customerScore.reduce(reducer));
// console.log("new survey score = " + newSurveySum);
// This line is the magic. It"s very similar to the standard ajax function we used.
// Essentially we give it a URL, we give it the object we want to send, then we have a "callback".
// The callback is the response of the server. In our case, we set up code in api-routes that "returns" true or false
// depending on if a tables is available or not.
$.post("/api/survey", newSurvey,
function(data) {
	
console.log(data);
});
//function friendQuery() {
// Here we get the location of the root page.
// We use this instead of explicitly saying the URL is localhost:3001 because the url will change when we deploy.
var currentURL = window.location.origin;
// The AJAX function uses the URL of our API to GET the data associated with it (initially set to localhost)
$.ajax({ url: currentURL + "/api/survey", method: "GET" })
.done(function(friendsData) {

var index = 0;
var lowestScore = 50;
//console.log(friendsData);
for (var i = 0; i < friendsData.length; i ++){
	var currentScore = 0
	
	

	//console.log("THE friends score is " + friendsData[i].score);
	for (var x = 0; x < friendsData[i].score.length; x ++){

		
	 currentScore += Math.abs(newSurvey.customerScore[x] - friendsData[i].score[x]);
	 
	}
	//console.log(currentScore);
	if (currentScore < lowestScore ){
	 	//console.log("it works");
	 	lowestScore = currentScore;
	 	index = i;
	 }
	// console.log(currentScore);
	// console.log(lowestScore);
	// console.log(index);
	
}
  console.log(friendsData[index].name);





});
// }
// friendQuery();
});
</script>